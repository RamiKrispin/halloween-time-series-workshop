---
title: "Plotting Time Series Object"
author: 'Rami Krispin'
date: "10/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      fig.height=5, 
                      fig.width=8, 
                      message=FALSE, 
                      warning=FALSE)
```


Currently, the main method for visualize `tsibble` objects is with the `autoplot` function from [fabletools](https://fabletools.tidyverts.org/) / [ggplot2](https://ggplot2.tidyverse.org/reference/index.html) packages to create auto-plots of `tsibble` objects.

Let's load and transform the natural gas consumption in the US into tsibble object and plot it:

```{r }
library(tsibble)
library(fabletools)
library(dplyr)

naturalgas_path <- paste(rprojroot::find_rstudio_root_file(), "data", "NATURALGAS.csv", sep = "/")

us_gas <- read.csv(naturalgas_path, stringsAsFactors = FALSE) %>%
  setNames(c("date", "y")) %>%
  mutate(date = yearmonth(as.Date(date))) %>%
  as_tsibble(index = "date")

us_gas %>% autoplot(.vars = y) 
```


As the `autoplot` function exported from the **ggplot2** package, we can customize the plot and add additional layers using any of the **ggplot2**  package functionality: 

```{r}
library(ggplot2)

us_gas %>% autoplot(.vars = y) + 
  xlab("Source: U.S. Bureau of Transportation Statistics, Natural Gas Consumption [NATURALGAS]") + 
  ylab("Billion Cubic Feet") + 
  ggtitle("US Natural Gas Consumption (Not Seasonally Adjusted)")
```

Last but not least, we can convert the plot into a plotly object using the `ggplotly` function from the [plotly](https://plotly.com/r/) package: 

```{r}
library(plotly)

p <- us_gas %>% autoplot(.vars = y) + 
  xlab("Source: U.S. Bureau of Transportation Statistics, Natural Gas Consumption [NATURALGAS]") + 
  ylab("Billion Cubic Feet") + 
  ggtitle("US Natural Gas Consumption (Not Seasonally Adjusted)")


ggplotly(p)
```


### Plotting multiple time series objects

```{r}
data("tourism")

nsw_tourism <- tourism %>% filter(State == "New South Wales", Purpose == "Holiday")


nsw_tourism <- tourism %>% filter(Region == "Sydney")

head(nsw_tourism)

key_data(nsw_tourism)
```

```{r}
nsw_tourism %>% autoplot()
```

